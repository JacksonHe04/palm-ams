# å…¨æ ˆç½‘ç«™éƒ¨ç½²å®Œæ•´è·¯çº¿ + è¸©å‘æ—¥è®°ï¼šäº‘æœåŠ¡å™¨ + uWSGI + Nginx + åŸŸåæ³¨å†Œ + Vercel + äº‘è§£æ DNS + SSL è¯ä¹¦ + HTTPSï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘/ç«å±±å¼•æ“/Cloudflare é€šç”¨ï¼‰

å®éªŒå®¤è¿™è¾¹ç€æ€¥ä¸Šçº¿ä½¿ç”¨ï¼Œè¶ç€äº”ä¸€å‡æœŸï¼ŒèŠ±äº† 3 ä¸ªæ™šä¸Šç£•ç£•ç»Šç»Šå¼„å®Œäº†ã€‚è¿™ 3 å¤©æ™šä¸Šç»™æˆ‘å¤´å¼„ç§ƒäº†ï¼Œç¬¬ä¸€æ¬¡åšç½‘ç«™çš„éƒ¨ç½²ï¼Œå®åœ¨æ˜¯å¤æ‚ã€‚

---

## ç¬¬ä¸€å¤©ï¼š5 æœˆ 4 æ—¥

### 1. äº‘æœåŠ¡å™¨

é¡¹ç›®éƒ¨ç½²åœ¨è…¾è®¯äº‘çš„äº‘æœåŠ¡å™¨ä¸Šï¼ŒæœåŠ¡å™¨æ˜¯å¥½å‡ å¹´å‰ä¹°çš„ï¼Œè¿è¡Œç€ä¸€ä¸ªç®€å•çš„ç½‘ç«™ï¼ˆä¸€ä¸ªå·¨å¤§çš„ HTMLï¼‰ï¼Œè€Œæˆ‘ä»¬çš„é¡¹ç›®æ¯”è¿™ä¸ªå¤æ‚å¾ˆå¤šï¼Œå¾—æ•´ä¸ªé‡æ–°éƒ¨ç½²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‰ææ˜¯å¾—æœ‰ä¸€å°äº‘æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯è…¾è®¯äº‘çš„ CVMï¼Œå®é™…ä¸Šä½¿ç”¨é˜¿é‡Œäº‘ç­‰å¹³å°çš„äº‘æœåŠ¡å™¨ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚

- [è…¾è®¯äº‘ äº‘æœåŠ¡å™¨ CVM](https://cloud.tencent.com/product/cvm)
- [é˜¿é‡Œäº‘ äº‘æœåŠ¡å™¨ ECS](https://ecs.console.aliyun.com/home)
- [ç«å±±å¼•æ“ äº‘æœåŠ¡å™¨](https://www.volcengine.com/product/ecs)

<aside>
ğŸ’¡

- [è…¾è®¯äº‘ äº‘æœåŠ¡å™¨ CVM](https://cloud.tencent.com/product/cvm)
- [é˜¿é‡Œäº‘ äº‘æœåŠ¡å™¨ ECS](https://ecs.console.aliyun.com/home)
- [ç«å±±å¼•æ“ äº‘æœåŠ¡å™¨](https://www.volcengine.com/product/ecs)
</aside>

### 2. å…‹éš†ä»£ç 

```bash
sudo apt update
sudo apt install git
```

```bash
git config --global user.name "ä½ çš„GitHubç”¨æˆ·å"
git config --global user.email "ä½ çš„GitHubé‚®ç®±"
```

```bash
ssh-keygen -t rsa -b 4096 -C "ä½ çš„GitHubé‚®ç®±"
```

```bash
cat ~/.ssh/id_rsa.pub
```

```bash
ssh -T git@github.com
```

<aside>
<img src="/icons/command-line_gray.svg" alt="/icons/command-line_gray.svg" width="40px" />

The authenticity of host '[github.com](http://github.com/) (IP åœ°å€)' can't be established.
RSA key fingerprint is SHA256:ä¸€ä¸²ä¹±ç .
Are you sure you want to continue connecting (yes/no/[fingerprint])?

</aside>

<aside>
<img src="/icons/command-line_gray.svg" alt="/icons/command-line_gray.svg" width="40px" />

Hi ä½ çš„GitHubç”¨æˆ·å! You've successfully authenticated, but GitHub does not provide shell access.

</aside>

```bash
git clone git@github.com:ä½ çš„GitHubç”¨æˆ·å/ä»“åº“å.git
```

### 3. åœ¨æœåŠ¡å™¨è¿è¡Œ

[Bilibili å°† Django é¡¹ç›®éƒ¨ç½²åˆ°è…¾è®¯äº‘è¿œç¨‹æœåŠ¡å™¨ä¸Š](https://www.bilibili.com/video/BV1Be4y1V7cv/?vd_source=3af67a6b8e7c99642545dea0fbf4cdb6#reply261097156849)

```bash
source ~/.bashrc
conda activate palm
python manage.py runserver 0.0.0.0:8001
```

---

## ç¬¬äºŒå¤©ï¼š5 æœˆ 5 æ—¥

### 4. uWSGI å®ˆæŠ¤è¿›ç¨‹

```markdown
[uwsgi]
chdir = /home/ubuntu/palm-ams/back-django
module = ApplicationSystem.wsgi
master = true
processes = 4
threads = 2
socket = 127.0.0.1:8001
chmod-socket = 664
vacuum = true
daemonize = /home/ubuntu/palm-ams/back-django/palm.log
pythonpath = /home/ubuntu/palm/ams/back-django
home = /home/ubuntu/anaconda3/envs/palm
```

### 5. Nginx åå‘ä»£ç†

```markdown
# HTTP æœåŠ¡å™¨ï¼Œå°†æ‰€æœ‰æµé‡é‡å®šå‘åˆ° HTTPS
server {
    listen 80;
    server_name 139.155.248.15 palm.inon.space joinpalm.inon.space;
    return 301 https://$server_name$request_uri;
}

# HTTPS æœåŠ¡å™¨
server {
    # SSL é»˜è®¤è®¿é—®ç«¯å£å·ä¸º 443
    listen 443 ssl;
    # è¯·å¡«å†™ç»‘å®šè¯ä¹¦çš„åŸŸå
    server_name 139.155.248.15 palm.inon.space joinpalm.inon.space;
    # è¯·å¡«å†™è¯ä¹¦æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„
    ssl_certificate /etc/nginx/palm.inon.space_bundle.crt;
    # è¯·å¡«å†™ç§é’¥æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„
    ssl_certificate_key /etc/nginx/palm.inon.space.key;
    ssl_session_timeout 5m;
    # è¯·æŒ‰ç…§ä»¥ä¸‹åè®®é…ç½®
    ssl_protocols TLSv1.2;
    # è¯·æŒ‰ç…§ä»¥ä¸‹å¥—ä»¶é…ç½®ï¼Œé…ç½®åŠ å¯†å¥—ä»¶ï¼Œå†™æ³•éµå¾ª openssl æ ‡å‡†ã€‚
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;
    ssl_prefer_server_ciphers on;

    location /static/ {
        alias /home/ubuntu/palm-ams/back-django/static/;
        add_header Cache-Control "public, max-age=31536000";

        types {
            text/css css;
            application/javascript js;
            image/svg+xml svg;
        }
    }

    add_header Cross-Origin-Opener-Policy "same-origin";
    add_header Cross-Origin-Embedder-Policy "require-corp";

    location / {
        include uwsgi_params;
        uwsgi_pass 127.0.0.1:8001;
    }
}
```

---

## ç¬¬ä¸‰å¤©ï¼š5 æœˆ 6 æ—¥

### 6. äº‘è§£æ DNS

1. åŸŸåæ³¨å†Œ

å°†ä¸€ä¸ª IP åœ°å€è£¸éœ²åœ¨å¤–é¢æ˜¾ç„¶æ˜¯ä¸ç¾è§‚çš„ã€‚IP åœ°å€å°±åƒäººçš„èº«ä½“ï¼Œæ˜¯ä¸æ–¹ä¾¿å±•ç¤ºç»™åˆ«äººçœ‹çš„ã€‚ä¸€æ–¹é¢ï¼ŒIP åœ°å€éƒ½æ˜¯ä¸€ä¸²æ•°å­—ï¼Œæ— æ³•è®©äººè®°ä½ï¼Œå¦ä¸€æ–¹é¢ï¼Œä¹Ÿä¸å¤ªå®‰å…¨ã€‚å°±åƒäººä¸äººè¡£æœä¸‹é¢çš„çš®è‚¤å®è´¨ä¸Šéš¾ä»¥åŒºåˆ†ï¼Œä¹Ÿå¸¸å¸¸ä¸ä¼šå±•ç¤ºäºäººä¸€æ ·ã€‚

æˆ‘ä»¬å¸Œæœ›çš„å½“ç„¶æ˜¯æœ‰ä¸€ä¸ªç‚«é…·å¥½è®°çš„åŸŸåï¼Œè®©ç”¨æˆ·åœ¨æµè§ˆå™¨çš„ URL æ è¾“å…¥åŸŸååï¼Œä¾¿å¯ä»¥ç›´æ¥è¿›å…¥åˆ°æˆ‘ä»¬çš„ç½‘é¡µã€‚ä½ ä¸€å®šè®°å¾— [google.com](http://google.com/)ã€[baidu.com](http://baidu.com/)ã€[x.ai](http://x.ai/) è¿™äº›ç»å…¸çš„åŸŸåï¼Œä½œä¸ºç‹¬ç«‹å¼€å‘è€…ï¼Œæ‹¥æœ‰ä¸€ä¸ªè‡ªå·±çš„åŸŸåä¹Ÿæ˜¯ç†æ‰€åº”å½“çš„äº‹æƒ…ã€‚

æˆ‘å»å¹´å¹´åº•åˆšå¥½æ³¨å†Œè¿‡ä¸€ä¸ªåŸŸå [inon.space](https://inon.space)ï¼Œä½†æ˜¯ä¸€ç›´æ²¡æœ‰ä½¿ç”¨ï¼Œå½“æ—¶æ˜¯åœ¨é˜¿é‡Œäº‘è´­ä¹°çš„ï¼Œä¸ºæœŸ 1 å¹´ï¼Œåº”è¯¥æ˜¯åå‡ å—é’±ã€‚

1. äº‘è§£æ DNS
- [é˜¿é‡Œäº‘ äº‘è§£æ DNS](https://dns.console.aliyun.com/#/dns/domainList)
- [è…¾è®¯äº‘ äº‘è§£æ DNS](https://console.cloud.tencent.com/cns)
- [ç«å±±å¼•æ“ TrafficRoute DNS å¥—ä»¶](https://console.volcengine.com/TrafficRoute/dns/publiczone)

[Cloudflare](https://blog.csdn.net/dreamingsleeping/article/details/139745997)

1. Vercel
- Vercel è‡ªå¸¦åŸŸåä¸ CNAME è‡ªå®šä¹‰åŸŸå
    
    

### 7. SSL è¯ä¹¦ä¸ HTTPS

å¦‚æœä½ è¿˜è®°å¾—è®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†çš„è¯ï¼Œåº”è¯¥çŸ¥é“ HTTP æ˜¯å­˜åœ¨å®‰å…¨éšæ‚£çš„ï¼Œç°ä»£ç½‘é¡µåŸºæœ¬ä¸Šéƒ½ç”¨ HTTPS ä»£æ›¿äº† HTTP ä½œä¸ºç½‘é¡µåœ°å€çš„å‰ç¼€ï¼Œå› ä¸º HTTPS ä¼šé€šè¿‡ SSL/TLS åè®®å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€‚

å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨æ‰“å¼€æˆ‘ä»¬ä»¥ HTTP ä¸ºå‰ç¼€çš„ç½‘é¡µæ—¶ï¼Œä¸€å®šä¼šè¢«æµè§ˆå™¨æé†’ï¼šè¿™ä¸å®‰å…¨ï¼æœ‰çš„æµè§ˆå™¨ç”šè‡³ä¼šæŠŠâ€œä¸å®‰å…¨â€å›ºå®šåœ¨ URL æ çš„å·¦ä¾§ï¼Œå¦‚æœä½ æœ‰å¼ºè¿«ç—‡ï¼Œä¸€å®šä¼šå¾ˆéš¾å—ã€‚

å‰æ–‡æåˆ°ï¼Œä½œä¸ºå¤‡ç”¨ï¼Œæˆ‘å°†é¡¹ç›®çš„å‰ç«¯é™æ€é¡µé¢ä¸€é”®éƒ¨ç½²åœ¨äº† Vercel ä¸Šã€‚Vercel è‡ªåŠ¨æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªåŸŸåï¼šhttps://palm-ams.vercel.appï¼Œä½†æ˜¯å½“æˆ‘ä»¬æ‰“å¼€è¿™ä¸ªç½‘é¡µæ—¶ï¼Œä¼šå‘ç°å‘æœåŠ¡ç«¯å‘é€çš„æ‰€æœ‰ XHR è¯·æ±‚éƒ½å¤±è´¥äº†ï¼Œæ§åˆ¶å°çš„æŠ¥é”™åŸå› ä¸ºï¼š

<aside>
<img src="/icons/clear_gray.svg" alt="/icons/clear_gray.svg" width="40px" />

å·²å±è”½ï¼šmixed-content

</aside>

äº¤ç»™ Claude ç¿»è¯‘å°±æ˜¯ï¼šHTTPS ç½‘é¡µæ— æ³•å‘ HTTP ç½‘é¡µå‘é€è¯·æ±‚ã€‚æˆ‘ä»¬çš„å‰ç«¯ç½‘ç«™æ˜¯ Vercel æä¾›çš„è‡ªå¸¦ HTTPS çš„ï¼Œè€Œæˆ‘ä»¬çš„æœåŠ¡ç«¯ç½‘ç«™ä»…ä»…æ˜¯æŠŠåŸŸå A åˆ°äº† IP åœ°å€ï¼Œå› æ­¤ä»ç„¶æ˜¯ HTTP ä½œä¸ºå‰ç¼€ã€‚

![Claude 3.5 Sonnet](attachment:d3977770-b846-40d8-a434-172ac8654cac:image.png)

Claude 3.5 Sonnet

æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬è®©æœåŠ¡ç«¯ç½‘ç«™åŸŸåå˜æˆ HTTPS å¼€å¤´ï¼Œå°±èƒ½è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š

1. HTTPS çš„ç½‘é¡µï¼ˆæ¯”å¦‚Vercel è‡ªåŠ¨éƒ¨ç½²çš„å‰ç«¯ç½‘é¡µï¼‰æ— æ³•å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚
2. æœåŠ¡ç«¯ç½‘é¡µå®‰å…¨æ€§ä¸ä½³

ä¸ºäº†è®©ç½‘ç«™æ‹¥æœ‰ HTTPSï¼Œéœ€è¦ä¸ºè¯¥åŸŸåç”³è¯·ä¸€ä¸ª SSL è¯ä¹¦ã€‚é˜¿é‡Œäº‘å’Œè…¾è®¯äº‘éƒ½æä¾›æ”¶è´¹å’Œå…è´¹çš„ SSL è¯ä¹¦æœåŠ¡ï¼Œå…¶ä¸­ï¼Œé˜¿é‡Œäº‘çš„å…è´¹ç‰ˆå«ä¸ªäººæµ‹è¯•è¯ä¹¦ã€‚æ”¶è´¹è¯ä¹¦ä¸€èˆ¬æ˜¯ 1 å¹´ï¼Œå…è´¹è¯ä¹¦ä¸€æ¬¡æ€§åªèƒ½ä¿æŒ 3 ä¸ªæœˆï¼Œä¸€å¹´å¯ä»¥ç”³è¯· 20 ä¸ªè¯ä¹¦ã€‚

æˆ‘å½“æ—¶å‡ ä¹æ˜¯åŒæ—¶ç”³è¯·çš„ä¸¤ä¸ªæœåŠ¡å•†çš„å…è´¹ç‰ˆ SSL è¯ä¹¦ï¼Œå½“å¤©æ™šä¸Šè…¾è®¯äº‘å°±ç»™æˆ‘å‘çŸ­ä¿¡æé†’è¯ä¹¦é¢å‘æˆåŠŸï¼Œäºæ˜¯ä¾¿ä»è…¾è®¯äº‘è¿™é‡Œè¿›è¡Œè¯ä¹¦çš„éƒ¨ç½²äº†ã€‚

[SSL è¯ä¹¦ Nginx æœåŠ¡å™¨ SSL è¯ä¹¦å®‰è£…éƒ¨ç½²ï¼ˆLinu](https://cloud.tencent.com/document/product/400/35244)

---